(function ($) {
    $.fn.extend({
        //新闻向上逐条滚动
        "newsMove": function (options) {
            if (!isValid(options))
                return this;
            if (options) {
                //存在参数时覆盖默认参数
                var opts = $.extend({}, defaluts, options);
            }
            else {
                //不存在参数时使用默认参数
                var opts = $.extend({}, defaluts);
            }
            return this.each(function () {
                var $this = $(this);
                var s = 0;
                var time = null,prevNext=true;

                function move() {
                    (prevNext)?s++:s--;
                    if (s > $this.find("li").length - 1) {
                        s = 0;
                    }
                    if(s<0){
                        s=$this.find("li").length - 1;
                    }
                    var move = s * -$this.height();
                    $this.find("ul").stop(true,true).animate({
                        marginTop: move
                    }, opts.timer/3);
                }
                if(opts.autoPlay){
                    time = setInterval(function () {
                        move();
                    }, opts.timer);
                }
                moseHover(opts, $this, time, move);
                $(".ytl_prev").click(function () {
                    prevNext=false;
                    move();
                    prevNext=true;
                });
                $(".ytl_next").click(function () {
                    prevNext=true;
                    move();
                });
            });
        },
        //手风琴
        "accordion": function (options) {
            if (!isValid(options))
                return this;
            if (options) {
                //存在参数时覆盖默认参数
                var opts = $.extend({}, defaluts, options);
            }
            else {
                //不存在参数时使用默认参数
                var opts = $.extend({}, defaluts);
            }
            return this.each(function () {
                var $this = $(this);
                var LtRBox = ".ytl_sfqListLtR",
                    leftBox = ".ytl_sfqListLeft",
                    rightBox = ".ytl_sfqListRight",
                    TtDBox = ".ytl_sfqListTtD",
                    topBox = ".ytl_sfqListTop",
                    downBox = ".ytl_sfqListDown";
                var LtRClass = "ytl_sfqListLtR",
                    leftClass = "ytl_sfqListLeft",
                    rightClass = "ytl_sfqListRight",
                    TtDClass = "ytl_sfqListTtD",
                    topClass = "ytl_sfqListTop",
                    downClass = "ytl_sfqListDown";
                var leftRightW = $(leftBox).width() + $(rightBox).width();
                if (opts.accordion == "LtR") {
                    $this.find(LtRBox).addClass(LtRClass).removeClass(TtDClass);
                    $this.find(leftBox).addClass(leftClass).removeClass(topClass);
                    $this.find(rightBox).addClass(rightClass).removeClass(downClass);
                    $(LtRBox).eq(0).css({"width": leftRightW});
                    var $thisLeftClick = $this.find(leftBox).width();
                    $(LtRBox).on(opts.clickHover,function () {
                        $(this).stop(true,true).animate({width: leftRightW}, opts.timer/3).siblings().stop(true,true).animate({width: $thisLeftClick}, opts.timer/3);
                    });
                }
                else {
                    $this.find(LtRBox).addClass(TtDClass).removeClass(LtRClass);
                    $this.find(leftBox).addClass(topClass).removeClass(leftClass);
                    $this.find(rightBox).addClass(downClass).removeClass(rightClass);
                    var topDownH = $(topBox).height() + $(downBox).height();
                    $this.find(TtDBox).eq(0).css({"height": topDownH});
                    var $thisTopClick = $(this).find(topBox).height();
                    $this.find(TtDBox).on(opts.clickHover,function () {
                        $(this).stop(true,true).animate({height: topDownH}, opts.timer/3).siblings().stop(true,true).animate({height: $thisTopClick}, opts.timer/3)
                    });
                }
            });
        },
        //无缝滚动
        "marquee": function (options) {
            if (!isValid(options)) return this;
            if (options) {
                var opts = $.extend({}, defaluts, options);
            }
            else {
                var opts = $.extend({}, defaluts);
            }
            return this.each(function () {
                var $this = $(this);
                var
                    lrUlBox = ".ytl_lrLbList",
                    lrLiBox = ".ytl_lrLbList li";
                var
                    tdUlBox = ".ytl_tdLbList",
                    tdLiBox = ".ytl_tdLbList li";
                var time = null;
                clearInterval(time);
                var s = 0;
                if(opts.scroll == "wfLtR"){
                    $this.addClass("ytl_conLrLB").removeClass("ytl_conTdLB");
                    $this.find(".ytl_marqueeList").addClass("ytl_lrLbList").find(".ytl_marqueeList").removeClass("ytl_tdLbList");
                    var $thisW = $(lrLiBox).outerWidth() * opts.showNum + parseInt($(lrLiBox).css("margin-right")) * (opts.showNum - 1);
                    $this.width($thisW);
                    $this.height($(lrLiBox).outerHeight());
                    $this.find(lrUlBox).width(($(lrLiBox).outerWidth() + parseInt($(lrLiBox).css("margin-right"))) * $(lrLiBox).length);
                    var moveNum = $(lrLiBox).outerWidth() + parseInt($(lrLiBox).css("margin-right"));
                    var i = 0;
                    for (i; i < opts.showNum; i++) {
                        var htm = $this.find(lrLiBox).eq(i).clone();
                        $this.find(lrLiBox).eq($this.find(lrLiBox).length - 1).after(htm);
                    }
                    $this.find(lrUlBox).width(($(lrLiBox).outerWidth() + parseInt($(lrLiBox).css("margin-right"))) * $(lrLiBox).length);

                    function wfLrScroll() {
                        (opts.direction == "left") ? s += -1 : s -= -1;
                        if (s < -($this.find(lrUlBox).width() - $this.width() - parseInt($(lrLiBox).css("margin-right")))) {
                            s = 0;
                        }
                        if (s > 0) {
                            s = -($this.find(lrUlBox).width() - $this.width() - parseInt($(lrLiBox).css("margin-right")));
                        }
                        if (opts.showNum < $this.find(lrLiBox).length) {
                            $this.find(lrUlBox).css({"left": s});
                        }
                    }
                    if(opts.autoPlay){
                        time = setInterval(function () {
                            wfLrScroll();
                        }, opts.timer);
                    }
                    moseHover(opts, $this, time, wfLrScroll);
                }
                else{
                    $this.addClass("ytl_conTdLB").removeClass("ytl_conLrLB");
                    $this.find(".ytl_marqueeList").addClass("ytl_tdLbList").find(".ytl_marqueeList").removeClass("ytl_lrLbList");
                    var thisH = $(tdLiBox).outerHeight() * opts.showNum + parseInt($(tdLiBox).css("margin-bottom")) * (opts.showNum - 1);
                    $this.width($this.find(tdLiBox).outerWidth());
                    $this.height(thisH);
                    var moveNum = $(lrLiBox).outerHeight() + parseInt($(lrLiBox).css("margin-bottom"));
                    var i = 0;
                    for (i; i < opts.showNum; i++) {
                        var htm = $this.find(tdLiBox).eq(i).clone();
                        $this.find(tdLiBox).eq($this.find(tdLiBox).length - 1).after(htm);
                    }

                    function wfTdScroll() {
                        (opts.direction == "top") ? s += -1 : s -= -1;
                        if (s < -($this.find(tdUlBox).height() - $this.height())) {
                            s = 0;
                        }
                        if (s > 0) {
                            s = -($this.find(tdUlBox).height() - $this.height() - parseInt($(tdLiBox).css("margin-bottom")));
                        }
                        if (opts.showNum < $this.find(tdLiBox).length) {
                            $this.find(tdUlBox).css({"top": s});
                        }
                    }
                    if(opts.autoPlay){
                        time = setInterval(function () {
                            wfTdScroll();
                        }, opts.timer);
                    }
                    moseHover(opts, $this, time, wfTdScroll);
                }
                $(this).parent().width($(this).outerWidth());
            });
        },
        // tab切换同时含有轮播图
        "multipleRolling": function (options) {
            if (!isValid(options))
                return this;
            if (options) {
                //存在参数时覆盖默认参数
                var opts = $.extend({}, defaluts, options);
            }
            else {
                //不存在参数时使用默认参数
                var opts = $.extend({}, defaluts);
            }
            return this.each(function () {
                var $this=$(this);
                var time=null,ulIndex=0,s=0;
                var divBox=".ytl_listBox",
                    ulBox=".ytl_listBox ul",
                    ulLiBox=".ytl_listBox ul li",
                    dlBox=".ytl_title .ytl_left",
                    linkBox=".ytl_title .ytl_right",
                    olBox=".ytl_pointLists",
                    olLiBox=".ytl_pointLists li";
                leftBox=".ytl_listLeft";
                rightBox=".ytl_listRight";
                initialize(0);
                if(!opts.prevNext) $this.find(".ytl_prevNext").remove();
                var liW=$this.find(ulLiBox).outerWidth(true);
                if(opts.wordList){
                    $this.find(leftBox).width(liW*opts.showNum-parseInt($this.find(ulLiBox).css("margin-right")));
                    $this.width((liW*opts.showNum-parseInt($this.find(ulLiBox).css("margin-right")))+$this.find(leftBox).outerWidth(true));
                } else{
                    $this.width(liW*opts.showNum-parseInt($this.find(ulLiBox).css("margin-right")));
                }
                (opts.group)?opts.moveNum=opts.showNum:opts.moveNum=1;
                isCreatePoint(opts, $this);
                $this.find(dlBox).find("dd").click(function () {
                    var index=$(this).index();
                    s=0;
                    $this.find(ulBox).css({"margin-left":0});
                    $(this).addClass("on").siblings().removeClass("on");
                    var findUlBox=$this.find(ulBox).eq(index);
                    findUlBox.parent().find(olLiBox).removeClass("on");
                    findUlBox.parent().find(olLiBox).eq(0).addClass("on");
                    initialize(index);
                });
                function animationNext() {
                    s++;
                    animationCon();
                }
                function animationPrev() {
                    s--;
                    animationCon();
                }
                if(opts.autoPlay){
                    time=setInterval(function () {
                        animationNext();
                    },opts.timer);
                }
                moseHover(opts, $this, time, animationNext);
                $this.find(".ytl_next").click(function () {
                    animationNext();
                });
                $this.find(".ytl_prev").click(function () {
                    animationPrev();
                });
                $this.find(olLiBox).click(function () {
                    var findUlBox=$this.find(ulBox).eq(ulIndex);
                    var index=$(this).index();
                    var liW=findUlBox.find("li").outerWidth(true);
                    $(this).addClass("on").siblings().removeClass("on");
                    findUlBox.stop().animate({"margin-left":-liW*opts.showNum*index},opts.timer/3);
                });
                function initialize(num) {
                    var findUlBox=$this.find(ulBox).eq(num);
                    var len=findUlBox.find("li").length;
                    $this.find(linkBox).hide();
                    $this.find(linkBox).eq(num).show();
                    $this.find(divBox).removeClass("on");
                    $this.find(divBox).eq(num).addClass("on");
                    var divW = "";
                    if(opts.divLevelNum>1){
                        divW = Math.ceil(len/opts.divLevelNum) * (findUlBox.find("li").outerWidth(true));
                        findUlBox.find("li").css({"position":"absolute"});
                        findUlBox.find("li").each(function (index) {
                            var leftNum=parseInt(index/opts.divLevelNum)*$(this).outerWidth(true);
                            var topNum=parseInt(index%opts.divLevelNum)*($(this).outerHeight(true));
                            $(this).css({"top":topNum,"left":leftNum});
                        });
                        findUlBox.height((findUlBox.find("li").outerHeight(true)+opts.marginNum)*opts.divLevelNum);
                    }else {
                        divW = len * (findUlBox.find("li").outerWidth(true));
                    }
                    findUlBox.width(divW);
                    if((!opts.group&&opts.showNum>1)||len/opts.showNum<=1||len/opts.showNum/opts.divLevelNum<=1) {
                        findUlBox.parent().find(".ytl_pointLists").remove();
                    }
                }
                function animationCon() {
                    var num=$this.find(dlBox).find(".on").index();
                    var findUlBox=$this.find(ulBox).eq(num);
                    var len=findUlBox.find("li").length;
                    var liW=findUlBox.find("li").outerWidth(true);
                    if(opts.moveNum<len){
                        var maxNum="";
                        (opts.group)?((opts.divLevelNum>1)?maxNum=Math.ceil(len/opts.moveNum/opts.divLevelNum)-1:maxNum=Math.ceil(len/opts.moveNum)-1):((opts.divLevelNum>1)?maxNum=findUlBox.width()/liW-opts.moveNum-1:maxNum=len-opts.showNum);
                        if(s>maxNum){
                            s=0;
                        }
                        if(s<0){
                            s=maxNum;
                        }
                        findUlBox.parent().find(olLiBox).removeClass("on");
                        findUlBox.parent().find(olLiBox).eq(s).addClass("on");
                        findUlBox.stop(true,true).animate({"margin-left":-liW*opts.moveNum*s},opts.timer/3);
                    }
                }
            });
        },
        //下拉选择
        "dropDown": function (options) {
            if (!isValid(options))
                return this;
            if (options) {
                //存在参数时覆盖默认参数
                var opts = $.extend({}, defaluts, options);
            }
            else {
                //不存在参数时使用默认参数
                var opts = $.extend({}, defaluts);
            }
            return this.each(function () {
                var $this=$(this);
                var chooseResult=".ytl_chooseResult",
                    ulBox=".ytl_chooseList",
                    ulLiBox=".ytl_chooseList li",
                    sanjia1="ytl_dropDownBg1",
                    sanjia2="ytl_dropDownBg2";
                $this.find(chooseResult).addClass(sanjia1);
                $this.find(chooseResult).click(function () {
                    $this.find(ulBox).slideToggle(function () {
                        $this.find(chooseResult).removeClass(sanjia1).removeClass(sanjia2);
                        if($this.find(ulBox).css("display")=="none"){
                            $this.find(chooseResult).addClass(sanjia1);
                        }
                        else {
                            $this.find(chooseResult).addClass(sanjia2);
                        }
                    });
                });
                $this.find(ulLiBox).click(function () {
                    $(this).addClass("on").siblings().removeClass("on");
                    $this.find(chooseResult).text($(this).text());
                    $this.find(ulBox).slideUp(function () {
                        $this.find(chooseResult).addClass(sanjia1).removeClass(sanjia2);
                    });
                });
            });
        },
        //中间大图显示
        "highlight": function(options) {
            if (!isValid(options)) return this;
            if (options) {
                var opts = $.extend({}, defaluts, options)
            } else {
                var opts = $.extend({}, defaluts)
            }
            return this.each(function() {
                var $this = $(this);
                var liBox = ".ytl_list li";
                var liActiveBox = ".ytl_list .ytl_active";
                var listBox = ".ytl_list";
                var len=$this.find(liBox).length;
                for (var i = 0; i < 2*len-1; i++) {
                    var htm = $this.find(liBox).eq(i).clone();
                    $this.find(liBox).eq($this.find(liBox).length - 1).after(htm)
                }
                var beforeLiH = $this.find(liBox).outerHeight(true);
                var beforeLiW = $this.find(liBox).outerWidth(true);
                $this.find(liBox).eq(Math.floor(opts.showNum / 2)).addClass("ytl_active").siblings().removeClass("ytl_active");
                var afterLiH = $this.find(liActiveBox).outerHeight(true);
                var afterLiW = $this.find(liActiveBox).outerWidth(true);
                $this.css({
                    "padding-top": (afterLiH - beforeLiH) / 2
                });
                var $thisLiW = 0,
                    $thisW = 0,
                    ulL = -parseInt($this.find(liBox).css("margin-left"));
                $this.find(liBox).each(function(index) {
                    if (index < opts.showNum) {
                        $thisW += $(this).outerWidth(true)
                    }
                    $thisLiW += $(this).outerWidth(true)
                });
                $this.width($thisW - parseInt($this.find(liBox).css("margin-left")) * 2);
                $this.height(afterLiH - (afterLiH - beforeLiH) / 2);
                $this.find(listBox).width($thisLiW);
                $this.find(listBox).css({
                    "margin-left": ulL
                });
                var s = Math.floor(opts.showNum / 2), time = null;
                function animation() {
                    s++;
                    move();
                }
                if(opts.autoPlay){
                    time = setInterval(function() {
                        animation()
                    }, opts.timer);
                    moseHover(opts, $this, time, animation);
                }
                $this.find(liBox).eq(len+Math.floor(opts.showNum / 2)).addClass("ytl_active").siblings().removeClass("ytl_active");
                $this.find(".ytl_active a").attr({"href":$this.find(".ytl_active").attr("data-href")});
                $this.find(listBox).css({"margin-left": -parseInt($this.find(liBox).css("margin-left"))-len* beforeLiW});
                $this.find(liBox).click(function () {
                    var beforeindex=$this.find(".ytl_active").index();
                    s=$(this).index();
                    if(beforeindex!==s){
                        $this.find("li a").attr({"href":"javascript:;"});
                    }
                    move();
                });
                function move() {
                    $this.find(liBox).addClass("tstAll");
                    $this.find(liBox).eq(s).addClass("ytl_active").siblings().removeClass("ytl_active");
                    var move =  -parseInt($this.find(liBox).css("margin-left")) -(s-Math.floor(opts.showNum / 2))* beforeLiW;
                    if (s >=2*len-1+Math.floor(opts.showNum / 2)) {
                        $this.find(listBox).stop(true,true).animate({
                            "margin-left": move
                        }, opts.timer/3,function () {
                            $this.find(liBox).removeClass("tstAll");
                            $this.find(liBox).eq(len+Math.floor(opts.showNum / 2)-1).addClass("ytl_active").siblings().removeClass("ytl_active");
                            $this.find(listBox).stop(true,true).animate({
                                "margin-left": -parseInt($this.find(liBox).css("margin-left"))-(len-1)* beforeLiW
                            }, 0);
                            s = Math.floor(opts.showNum / 2);
                            $this.find(".ytl_active a").attr({"href":$this.find(".ytl_active").attr("data-href")});
                        });
                    }
                    else if (s <=Math.floor(opts.showNum / 2)) {
                        $this.find(listBox).stop(true,true).animate({
                            "margin-left": move
                        }, opts.timer/3,function () {
                            $this.find(liBox).removeClass("tstAll");
                            $this.find(liBox).eq(len+Math.floor(opts.showNum / 2)).addClass("ytl_active").siblings().removeClass("ytl_active");
                            $this.find(listBox).stop(true,true).animate({
                                "margin-left": -parseInt($this.find(liBox).css("margin-left"))-len* beforeLiW
                            }, 0);
                            s = Math.floor(opts.showNum / 2);
                            $this.find(".ytl_active a").attr({"href":$this.find(".ytl_active").attr("data-href")});
                        });
                    }
                    else {
                        $this.find(listBox).stop(true,true).animate({
                            "margin-left": move
                        },  opts.timer/3,function () {
                            $this.find(".ytl_active a").attr({"href":$this.find(".ytl_active").attr("data-href")});
                        });
                    }
                }
            })
        },
        //时间轴
        "dateLine": function (options) {
            if (!isValid(options))
                return this;
            if (options) {
                //存在参数时覆盖默认参数
                var opts = $.extend({}, defaluts, options);
            }
            else {
                //不存在参数时使用默认参数
                var opts = $.extend({}, defaluts);
            }
            return this.each(function () {
                var $this=$(this);
                var ulBox = $this.find("ul");
                var ulLiBox = ulBox.find("li");
                var olLiBox = $this.find("ol li");
                var prevBox = $this.find(".ytl_prev");
                var nextBox = $this.find(".ytl_next");
                olLiBox.eq(0).show().siblings().hide();
                ulBox.width(ulLiBox.outerWidth(true) * ulLiBox.length);
                ulLiBox.on("click", function () {
                    var num = $(this).index();
                    $(this).addClass("on").siblings().removeClass("on");
                    olLiBox.eq(num).show().siblings().hide();
                    if(num>=Math.floor(opts.showNum/2)){
                        var leftVal="";
                        if(-(num-Math.floor(opts.showNum/2))*ulLiBox.outerWidth(true)<-(ulLiBox.length-opts.showNum)*ulLiBox.outerWidth(true)){
                            leftVal=-(ulLiBox.length-opts.showNum)*ulLiBox.outerWidth(true);
                        }
                        else {
                            leftVal=-(num-Math.floor(opts.showNum/2))*ulLiBox.outerWidth(true);
                        }
                        ulBox.stop(true,true).animate({"left": leftVal},opts.timer/3);
                    }
                });
                var num = 1;

                function prevNextClick(prevNext) {
                    ulLiBox.each(function () {
                        if ($(this).hasClass("on")) {
                            num = $(this).index();
                        }
                    });
                    (prevNext)?num--:num++;
                    if(num<0){
                        num=0;
                        ulBox.stop(true,true).animate({"left": 0},opts.timer/3);
                    }
                    if(num>=Math.floor(opts.showNum/2)){
                        var leftVal="";
                        if(-(num-Math.floor(opts.showNum/2))*ulLiBox.outerWidth(true)<-(ulLiBox.length-opts.showNum)*ulLiBox.outerWidth(true)){
                            leftVal=-(ulLiBox.length-opts.showNum)*ulLiBox.outerWidth(true);
                        }
                        else {
                            leftVal=-(num-Math.floor(opts.showNum/2))*ulLiBox.outerWidth(true);
                        }
                        ulBox.stop(true,true).animate({"left": leftVal},opts.timer/3);
                    }
                    ulLiBox.eq(num).addClass("on").siblings().removeClass("on");
                    olLiBox.eq(num).show().siblings().hide();
                }

                prevBox.on("click", function () {
                    prevNextClick(true);
                });
                nextBox.on("click", function () {
                    prevNextClick(false);
                });
            });
        },
        //弹出层
        "layout": function (options) {
            if (!isValid(options))
                return this;
            if (options) {
                //存在参数时覆盖默认参数
                var opts = $.extend({}, defaluts, options);
            }
            else {
                //不存在参数时使用默认参数
                var opts = $.extend({}, defaluts);
            }
            return this.each(function () {
                var $this=$(this);
                var conBox=".ytl_layoutCon";
                var conBgBox=".ytl_layoutCon,.ytl_layoutBg";
                var btnBox=".ytl_layoutBtn";
                var closeBox=".ytl_layoutClose";
                var left=($(window).width()-$this.find(conBox).width())/2;
                var top=($(window).height()-$this.find(conBox).height())/2;
                $this.find(conBox).css({"left":left,"top":top});
                $this.find(closeBox).css({"right":left,"top":top});
                $this.find(btnBox).click(function () {
                    if($this.find(conBgBox).hide()){
                        $this.find(conBgBox).show();
                    }
                    else {
                        $this.find(conBgBox).hide();
                    }
                });
                $this.find(closeBox).click(function () {
                    $this.find(conBgBox).hide();
                });
            });
        },
        // 图片等比缩放
        "imgScale": function (options) {
            if (!isValid(options))
                return this;
            if (options) {
                //存在参数时覆盖默认参数
                var opts = $.extend({}, defaluts, options);
            }
            else {
                //不存在参数时使用默认参数
                var opts = $.extend({}, defaluts);
            }
            return this.each(function () {
                var $this=$(this),time;
                var imgBox=$this.find(".img"),
                    imgTag=$this.find(".img img");
                time=setInterval(function () {
                    for (var i = 0; i < imgTag.length; i++) {
                        var imginnerWidth = imgTag[i].naturalWidth;
                        var imginnerHeight = imgTag[i].naturalHeight;
                        var boxWidth = imgBox.width();
                        var boxHeight = imgBox.height();
                        var imgScale=imginnerWidth / imginnerHeight;/*图片比例*/
                        var boxScale=boxWidth / boxHeight;/*盒子比例*/
                        var imgWidth = imgScale * boxHeight;
                        var imgHeight = boxWidth/imgScale;
                        if(opts.scale){
                            if(imgScale>boxScale){large();}
                            if(imgScale==boxScale){equal();}
                            if(imgScale<boxScale){small();}
                        }else {
                            if(imgScale>boxScale){small();}
                            if(imgScale==boxScale){equal();}
                            if(imgScale<boxScale){large();}
                        }
                    }
                    /*比例：大、等、小*/
                    function large() {
                        imgTag.eq(i).css({"height":"100%","width":imgScale*boxHeight+"px","margin-left":-(imgScale*boxHeight-boxWidth)/2+"px"});
                    }
                    function equal() {
                        imgTag.eq(i).css({"height":"100%","height":"100%"});
                    }
                    function small() {
                        imgTag.eq(i).css({"width":"100%","height":boxWidth/imgScale+"px","margin-top":-(boxWidth/imgScale-boxHeight)/2+"px"});
                    }
                },10);
            });
        },
        //上下居中对齐显示
        "alignTBC": function (options) {
            if (!isValid(options))
                return this;
            if (options) {
                //存在参数时覆盖默认参数
                var opts = $.extend({}, defaluts, options);
            }
            else {
                //不存在参数时使用默认参数
                var opts = $.extend({}, defaluts);
            }
            return this.each(function () {
                var $this=$(this),timechange;
                var ulBox=$this.find("ul"),
                    ulLiBox=$this.find("ul li"),
                    ulLiW=ulLiBox.outerWidth(true),

                    olBox=$this.find("ol"),
                    olLiBox=$this.find("ol li"),
                    olLiW=olLiBox.outerWidth(true),
                    oldLen=olLiBox.length,

                    ulLiShow=Math.ceil($this.width()/ulLiW);
                olLiShow=Math.ceil($this.width()/olLiW);

                var s=0,time,newLen=0;
                for(var i=0;i<oldLen;i++){
                    ulBox.append(ulLiBox.eq(i).clone());
                    olBox.append(olLiBox.eq(i).clone());
                    newLen=oldLen+i+1;
                }
                ulLiBox=$this.find("ul li");
                olBox.width(newLen*olLiBox.outerWidth(true));
                olBox.css({"margin-left":-Math.abs(ulLiShow-olLiShow)*olLiW+olLiW});
                ulBox.width(newLen*ulLiBox.outerWidth(true));
                ulLiBox.eq(Math.floor(ulLiShow/2)).addClass("on");
                function move(next) {
                    (next)?s++:s--;
                    moveCon();
                }
                function autoplay() {
                    if(opts.autoPlay){
                        time=setInterval(function () {
                            move(true);
                        },opts.timer);
                    }
                }
                autoplay();
                ulLiBox.click(function () {
                    s=$(this).index()-Math.floor(ulLiShow/2);
                    moveCon();
                });
                moseHove(olLiBox);
                moseHove(ulLiBox);
                moseHove($this.find(".ytl_next,.ytl_prev"));
                function moseHove(box){
                    box.hover(function () {
                        clearInterval(time);
                    },function () {
                        autoplay();
                    })
                }
                $this.find(".ytl_prev").click(function () {
                    move(false);
                });
                $this.find(".ytl_next").click(function () {
                    move(true);
                })
                function moveCon() {
                    ulLiBox.eq(Math.floor(ulLiShow/2)+s).addClass("on").siblings().removeClass("on");
                    if(s>oldLen){
                        s=1;
                        ulLiBox.eq(Math.ceil(ulLiShow/2)).addClass("on");
                        olBox.css({"margin-left":-Math.abs(ulLiShow-olLiShow)*olLiW+olLiW}).stop(true,true).animate({"margin-left":-Math.abs(ulLiShow-olLiShow)*olLiW+olLiW-s*olLiW},0);
                        ulBox.css({"margin-left":0}).stop(true,true).animate({"margin-left":-s*ulLiW},0);
                    }
                    else if(s<0){
                        s=oldLen-1;
                        ulLiBox.eq(s+Math.floor(ulLiShow/2)).addClass("on");
                        olBox.css({"margin-left":-Math.abs(ulLiShow-olLiShow)*olLiW+olLiW-(s+1)*olLiW}).stop(true,true).animate({"margin-left":-Math.abs(ulLiShow-olLiShow)*olLiW+olLiW-s*olLiW},0);
                        ulBox.css({"margin-left":-(s+1)*ulLiW}).stop(true,true).animate({"margin-left":-s*ulLiW},0);
                    }
                    else {
                        olBox.stop(true,true).animate({"margin-left":-Math.abs(ulLiShow-olLiShow)*olLiW+olLiW-s*olLiW},opts.timer/3);
                        ulBox.stop(true,true).animate({"margin-left":-s*ulLiW},opts.timer/3);
                    }
                }
            });
        },
        //banner
        "banner": function (options) {
            if (!isValid) {
                return this;
            }
            if (options) {
                var opts = $.extend({}, defaluts, options);
            } else {
                var opts = $.extend({}, defaluts);
            }
            return this.each(function () {
                var $this = $(this);
                isCreatePoint(opts, $this);
                isCreateImg(opts,$this);
                var dayList = "",
                    imgBox=$this.find(".ytl_picCarousel"),
                    pointBox=$this.find(".ytl_pointLists"),
                    smallImgBox=$this.find(".ytl_smallImgList"),
                    hoverBox=opts.hover_box;
                pointBox.find("li").eq(0).addClass("on");
                imgBox.find("li").eq(0).css({"opacity": "1"}).siblings().css({"opacity": "0"});
                var s = 0;
                var time = null;
                function mytime() {
                    var Lenth = imgBox.find("li").length;
                    if (s >= Lenth) {
                        s = 0;
                        smallImgBox.stop(true,true).animate({"margin-left":0},opts.timer/3);
                    }
                    if(s<0){
                        s=Lenth-1;
                    }
                    f();
                }
                time = setInterval(function () {
                    s++;
                    mytime();
                }, opts.timer);
                $(hoverBox).hover(function () {
                    clearInterval(time);
                }, function () {
                    time = setInterval(function () {
                        s++;
                        mytime();
                    }, opts.timer);
                });
                pointBox.find("li").click(function () {
                    var num=$(this).index();
                    s=num;
                    f();
                });
                smallImgBox.find("li").click(function () {
                    var num=$(this).index();
                    s=num;
                    f();
                });
                $this.find(".ytl_next").click(function () {
                    s++;
                    mytime();
                });
                $this.find(".ytl_prev").click(function () {
                    s--;
                    mytime();
                });
                function f() {
                    var beforeOn=pointBox.find(".on").index();
                    if(s!=beforeOn){
                        imgBox.find("li").stop(true,true).animate({"opacity": "0"}, opts.timer/3);
                        imgBox.find("li").eq(s).stop(true,true).animate({"opacity": "1"}, opts.timer/3);
                        pointBox.find("li").eq(s).addClass("on").siblings().removeClass("on");
                        smallImgBox.find("li").eq(s).addClass("on").siblings().removeClass("on");
                        var smallShow=Math.floor(smallImgBox.parent().outerWidth(true)/smallImgBox.find("li").outerWidth(true))-1;
                        if(s>smallShow-1){
                            smallImgBox.stop(true,true).animate({"margin-left":-(s-smallShow)*smallImgBox.find("li").outerWidth(true)},opts.timer/3);
                        }
                    }
                }
            })
        },
        //百合窗
        "lilyWindow": function (options) {
            if (!isValid(options))
                return this;
            if (options) {
                //存在参数时覆盖默认参数
                var opts = $.extend({}, defaluts, options);
            }
            else {
                //不存在参数时使用默认参数
                var opts = $.extend({}, defaluts);
            }
            return this.each(function () {
                var $this=$(this);
                isCreatePoint(opts, $this);
                isCreateImg(opts,$this);
                //分割图片
                //基本参数
                var createSize=60,createNum="",cNum=0,
                    ulW=$this.find("ul").width(),
                    ulH=$this.find("ul").height(),
                    lNum=Math.ceil(ulW/createSize),
                    vNum=Math.ceil(ulH/createSize),
                    createW=ulW/lNum,
                    createH=ulH/vNum,
                    createImg=$this.find(".ytl_createImg");
                createImg.css({"width":ulW,"height":ulH});
                //分割函数c，type参数：1横条，2竖条，3方格；src是图片路径
                function c(type,src) {
                    (type==1)?cNum=vNum:(type==2)?cNum=lNum:cNum=lNum*vNum;
                    for(var i=0;i<cNum;i++){
                        createNum+="<div>"+i+"</div>";
                    }
                    createImg.append(createNum);
                    createImg.find("div").each(function (index) {
                        $(this).css({
                            "width":
                                (type==1)?"100%":
                                    createW,
                            "height":
                                (type==2)?"100%":
                                    createH,
                            "left":
                                (type==1)?"0":
                                    (type==2)?createW*index:
                                        parseInt(index%lNum)*createW,
                            "top":
                                (type==1)?createH*index:
                                    (type==2)?"0":
                                        parseInt(index/lNum)*createH,
                            "background-image":"url("+src+")",
                            "background-size": ulW+"px "+ulH+"px",
                            "background-position":
                                (type==1)?"top -"+createH*index+"px left":
                                    (type==2)?"top left -"+createW*index+"px":
                                        "top -"+parseInt(index/lNum)*createH+"px left -"+parseInt(index%lNum)*createW+"px",
                        })
                    });
                }
                function a() {
                    c(3,$this.find("ul li").eq(0).find("img").attr("src"));
                }
            });
        },
        // 模板
        /*"dropDown": function (options) {
            if (!isValid(options))
                return this;
            if (options) {
                //存在参数时覆盖默认参数
                var opts = $.extend({}, defaluts, options);
            }
            else {
                //不存在参数时使用默认参数
                var opts = $.extend({}, defaluts);
            }
            return this.each(function () {
                var $this=$(this);
            });
        }*/
    });

    //默认参数
    var defaluts = {
        autoPlay: true,
        group:false,
        moseHover: true,        // 鼠标移入是否停止动画，默认停止true
        hover_box:"li,.ytl_next,.ytl_prev",           //默认移入li和上下切换按钮停止动画
        timer: 20,
        accordion: "FtR",       //手风琴排列方向默认FtR左往右
        clickHover: "hover",    //判断事件为点击还是移入移出，默认为移入移出
        scroll: "lrScroll",     //滚动方式（lrScroll，wfScroll），默认lrScroll左右滚动
        showNum: 4,                 //轮播滚动显示数量
        direction: "left",      //滚动方向，默认left向左
        divLevelNum:5,
        moveNum: 1,                 //轮播滚动移动数量
        marginNum:0,
    };

    //私有方法，检测参数是否合法
    function isValid(options) {
        return !options || (options && typeof options === "object") ? true : false;
    }
    /*是否移入停止*/
    function moseHover(opts, $this, time, fn) {
        //鼠标移入是否停止动画
        if (opts.moseHover == true) {
            $this.find(opts.hover_box).hover(function () {
                clearInterval(time);
            }, function () {
                if(opts.autoPlay){
                    time = setInterval(function () {
                        fn();
                    }, opts.timer);
                }
            });
        }
    }
    /*创建点点*/
    function isCreatePoint(opts, $this) {
        $this.find("ul").each(function (index) {
            var pointList = "",
                ulBox=$this.find("ul").eq(index),
                olBox=ulBox.parent().find(".ytl_pointLists"),
                len=ulBox.find("li").length;
            if(opts.group){
                for(var i=0;i<len/opts.moveNum/opts.divLevelNum;i++){
                    pointList += "<li></li>";
                }
            }else {
                for(var i=0;i<len;i++){
                    pointList += "<li></li>";
                }
            }
            olBox.html(pointList);
            olBox.find("li").eq(0).addClass("on");
            olBox.width(olBox.find("li").outerWidth(true)*olBox.find("li").length);
        });
    }
    function isCreateImg(opts, $this) {
        var smallImgList = "",smallImgListW="",
            smallImgBox=$this.find(".ytl_smallImgLists");
        for (var i = 0; i < $this.find("ul>li").length; i++) {
            var smallImgCon = $this.find("ul>li").eq(i).find("img").attr("src");
            smallImgList += "<li style='background-image: url("+smallImgCon+")'></li>";
        }
        $this.find(".ytl_smallImgList").append(smallImgList);
        $this.find(".ytl_smallImgList>li").eq(0).addClass("on");
        $this.find(".ytl_smallImgList>li").outerWidth(smallImgBox.width()/opts.showNum);
        $this.find(".ytl_smallImgList").width($this.find(".ytl_smallImgList>li").length*$this.find(".ytl_smallImgList>li").outerWidth(true));
    }
})(window.jQuery);